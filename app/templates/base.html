<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{ title if title else "RAG Chatbot" }}</title>
    <link rel="stylesheet" href="{{ url_for('static', path='css/styles.css') }}" />
  </head>
  <body>
    <div class="app-shell">
      <aside class="nav-rail">
        <button class="menu-btn" id="menuBtn" type="button" aria-expanded="false" aria-controls="menuPanel">
          <span class="menu-icon"></span>
        </button>
        <div class="menu-panel" id="menuPanel">
          <div class="menu-header">Menu</div>
          <a class="menu-item {% if active == 'chat' %}active{% endif %}" href="/chat">
            <span class="menu-dot"></span>
            <span>New Chat</span>
          </a>
          <a class="menu-item {% if active == 'data' %}active{% endif %}" href="/data-management">
            <span class="menu-dot"></span>
            <span>Data Management</span>
          </a>
          <a class="menu-item {% if active == 'settings' %}active{% endif %}" href="/settings">
            <span class="menu-dot"></span>
            <span>Settings</span>
          </a>
        </div>
      </aside>
      <section class="inbox-panel">
        {% block inbox %}
        <div class="inbox-empty">
          <div class="inbox-title">Inbox</div>
          <p class="muted">Your recent conversations appear here.</p>
        </div>
        {% endblock %}
      </section>
      <main class="main-panel">{% block content %}{% endblock %}</main>
    </div>

    <script>
      (function () {
        const btn = document.getElementById("menuBtn");
        const panel = document.getElementById("menuPanel");
        if (!btn || !panel) return;

        const closePanel = (event) => {
          if (panel.contains(event.target) || btn.contains(event.target)) return;
          panel.classList.remove("is-open");
          btn.setAttribute("aria-expanded", "false");
        };

        btn.addEventListener("click", (event) => {
          event.stopPropagation();
          const isOpen = panel.classList.toggle("is-open");
          btn.setAttribute("aria-expanded", isOpen ? "true" : "false");
        });

        document.addEventListener("click", closePanel);
      })();
    </script>
  </body>
</html>

